<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
    <title>Home Athan Automation</title>

    <!-- PWA Manifest -->
    <link rel="manifest" href="/static/manifest.json">

    <!-- Theme Color -->
    <meta name="theme-color" content="#1a1a2e">

    <!-- iOS PWA Support -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Home Athan">
    <link rel="apple-touch-icon" href="/static/img/icon-192x192.png">

    <!-- Samsung/Android PWA Support -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Home Athan">

    <!-- Prevent text selection and callouts for app-like feel -->
    <meta name="format-detection" content="telephone=no">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Inter:wght@300;400;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/static/style.css?v=6">
</head>

<body>
    <div class="app-container">
        <div id="toast-container"></div>
        <header>
            <div class="logo">Home Athan</div>
            <nav>
                <button id="settings-trigger" class="icon-btn" aria-label="Settings">
                    <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                        <path
                            d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.61l-1.92-3.32a.488.488 0 0 0-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 0 0-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.58 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z" />
                    </svg>
                </button>
            </nav>
        </header>

        <!-- DASHBOARD TAB (Default) -->
        <main id="dashboard" class="view-content active">
            <!-- Hero Card Only (No Grid Needed) -->
            <section id="main-hero-card" class="glass-card hero-card">
                <!-- Top Area: Time & Date -->
                <div class="hero-top-area">
                    <div id="current-time-big" class="time-big">--:--:--</div>
                    <div class="date-row-3col">
                        <div class="date-col left">
                            <span id="greg-day-month" class="date-line-main">--</span>
                            <span id="greg-year" class="date-line-sub">--</span>
                        </div>
                        <div class="date-col center">
                            <span id="day-name" class="day-highlight">--</span>
                        </div>
                        <div class="date-col right">
                            <span id="hijri-day-month" class="date-line-main">--</span>
                            <span id="hijri-year" class="date-line-sub">--</span>
                        </div>
                    </div>
                </div>

                <!-- Circular Timer -->
                <div class="circular-timer-wrapper">
                    <svg class="progress-ring" width="320" height="320">
                        <circle class="progress-ring__circle-bg" stroke="rgba(255,255,255,0.1)" stroke-width="8"
                            fill="transparent" r="150" cx="160" cy="160" />
                        <circle class="progress-ring__circle" stroke="var(--accent)" stroke-width="8" fill="transparent"
                            r="150" cx="160" cy="160" />
                    </svg>

                    <div class="timer-inner-content">
                        <img id="hero-moon-image" src="" alt="Moon Phase" />
                        <div class="next-prayer-header">
                            <div id="next-prayer-icon" class="prayer-icon-large">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12 2L2 7l10 5 10-5-10-5zm0 9l2.95 2.95 4.95-4.95" />
                                </svg>
                            </div>
                            <h2 id="next-prayer-name">--</h2>
                        </div>
                        <div id="countdown" class="countdown-circular">--:--:--</div>
                        <div class="next-time-label" id="next-prayer-time">--:--</div>
                    </div>
                </div>
                <!-- Moon Info (Outside Circle) -->
                <div id="hero-moon-info"></div>
            </section>

            <!-- Prayer Schedule (Bottom Row) -->
            <section class="prayer-scroll-container">
                <div id="prayer-times-list" class="prayer-list-row">
                    <!-- Populated by JS -->
                </div>
            </section>

            <div class="last-update-container">
                Last updated: <span id="last-updated">Never</span>
            </div>
        </main>

        <!-- SETTINGS VIEW (Contains Calculation and Schedule) -->
        <main id="settings" class="view-content">
            <div class="settings-header-nav">
                <button id="back-to-dashboard" class="back-btn">
                    <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M19 12H5" />
                        <path d="M12 19l-7-7 7-7" />
                    </svg>
                    Back
                </button>
                <div class="sub-nav">
                    <button class="sub-nav-btn active" data-subtab="calculation">Calculation</button>
                    <button class="sub-nav-btn" data-subtab="schedule">Schedule</button>
                    <button class="sub-nav-btn" data-subtab="astronomy">Astronomy</button>
                </div>
            </div>

            <!-- SUB-TAB: CALCULATION -->
            <div id="sub-calculation" class="sub-content active">
                <div class="calculation-grid">
                    <!-- Column 1: Calculation -->
                    <section class="calc-column">
                        <h2 class="section-title">Prayer Calculation</h2>
                        <div class="form-group">
                            <label>Calculation Method</label>
                            <select id="calc-method">
                                <option value="MWL">Muslim World League (MWL)</option>
                                <option value="ISNA">Islamic Society of North America (ISNA)</option>
                                <option value="EGYPT">Egyptian General Authority of Survey</option>
                                <option value="MAKKAH">Umm al-Qura University (Makkah)</option>
                                <option value="KARACHI">University of Islamic Sciences (Karachi)</option>
                                <option value="TEHRAN">Institute of Geophysics, Univ. of Tehran</option>
                                <option value="JAFARI">Shia Ithna Ashari (Jafari)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Asr Method</label>
                            <select id="asr-method">
                                <option value="STANDARD">Standard (Shafi, Maliki)</option>
                                <option value="HANAFI">Hanafi</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>High Latitude Rule</label>
                            <select id="high-lat-rule">
                                <option value="NONE">None</option>
                                <option value="MIDDLENIGHT">Middle of Night</option>
                                <option value="ONESEVENTH">One Seventh</option>
                                <option value="ANGLEBASED">Angle Based</option>
                                <option value="NEARESTLAT">Nearest Latitude</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Hijri Offset</label>
                            <select id="hijri-offset">
                                <option value="-2">-2 Days</option>
                                <option value="-1">-1 Day</option>
                                <option value="0">0 (Default)</option>
                                <option value="+1">+1 Day</option>
                                <option value="+2">+2 Days</option>
                            </select>
                        </div>
                    </section>

                    <!-- Column 2: Location -->
                    <section class="calc-column">
                        <h2 class="section-title">Location</h2>
                        <div class="form-group">
                            <label>Country</label>
                            <select id="country-select">
                                <!-- Populated by JS -->
                            </select>
                        </div>

                        <div class="form-group">
                            <label>City</label>
                            <select id="city-select">
                                <option value="custom">Custom Location</option>
                                <!-- Populated by JS -->
                            </select>
                        </div>

                        <div class="row">
                            <div class="col">
                                <div class="form-group">
                                    <label>Latitude</label>
                                    <input type="number" step="any" id="lat">
                                </div>
                            </div>
                            <div class="col">
                                <div class="form-group">
                                    <label>Longitude</label>
                                    <input type="number" step="any" id="lon">
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Time Zone</label>
                            <select id="timezone">
                                <option value="Europe/London">Europe/London</option>
                                <option value="Europe/Paris">Europe/Paris</option>
                                <option value="Asia/Riyadh">Asia/Riyadh</option>
                                <option value="Asia/Dubai">Asia/Dubai</option>
                                <option value="America/New_York">America/New_York</option>
                                <option value="UTC">UTC</option>
                            </select>
                        </div>
                    </section>
                </div>
                <button id="save-calc-btn" class="save-btn mt-4">Save Calculation Settings</button>
            </div>

            <!-- SUB-TAB: SCHEDULE -->
            <div id="sub-schedule" class="sub-content">
                <section class="settings-form">
                    <!-- Removed title here as requested previously and context is clear via tabs -->
                    <p class="section-desc">Configure audio, reminders, and target speakers for each prayer.</p>

                    <div class="form-group">
                        <div class="checkbox-group" id="prayer-selection">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                    <button id="save-schedule-btn" class="save-btn">Save Schedule Settings</button>
                </section>
            </div>

            <!-- SUB-TAB: ASTRONOMY -->
            <div id="sub-astronomy" class="sub-content">
                <section class="astronomy-panel visible" id="astronomy-data">
                    <!-- Moon Card -->
                    <div class="astro-card moon-card">
                        <div class="moon-visual">
                            <img id="moon-image" src="/static/img/moon/0.png" alt="Moon Phase" class="moon-image">
                        </div>
                        <div class="astro-info">
                            <div class="astro-label">MOON PHASE</div>
                            <div class="astro-value-main" id="moon-phase">--</div>
                            <div class="astro-sub" id="moon-illum">0%</div>
                        </div>
                    </div>
                    <!-- Sun Card -->
                    <div class="astro-card sun-card">
                        <div class="sun-compass">
                            <svg viewBox="0 0 100 100" class="compass-svg">
                                <circle cx="50" cy="50" r="45" stroke="rgba(255,255,255,0.1)" stroke-width="1"
                                    fill="transparent" />
                                <text x="50" y="15" text-anchor="middle" fill="#666" font-size="10">N</text>
                                <text x="85" y="52" text-anchor="middle" fill="#666" font-size="10">E</text>
                                <text x="50" y="90" text-anchor="middle" fill="#666" font-size="10">S</text>
                                <text x="15" y="52" text-anchor="middle" fill="#666" font-size="10">W</text>
                                <line id="sun-pointer" x1="50" y1="50" x2="50" y2="20" stroke="var(--accent-gold)"
                                    stroke-width="2" stroke-linecap="round" />
                                <circle cx="50" cy="50" r="3" fill="#fff" />
                            </svg>
                        </div>
                        <div class="astro-info">
                            <div class="astro-label">SUN POSITION</div>
                            <div class="astro-value-main" id="sun-az">--°</div>
                            <div class="astro-sub" id="sun-alt">--° Altitude</div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <script src="/static/script.js?v=9"></script>
</body>

</html>